<!DOCTYPE html>
<html lang="ja">
<head>
  <link href="https://fonts.googleapis.com/css2?family=M+PLUS+1p:wght@300;400;700&display=swap" rel="stylesheet"> 
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>音声再生</title>
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <div class="app">
    <header class="app__header">
      <h1 class="title">音声再生</h1>
      <p class="subtitle">ローカルに保存してキー再生・スペースで停止</p>
    </header>

    <!-- 追加フォーム -->
    <section class="panel panel--form" aria-labelledby="addFormTitle">
      <div class="panel__head">
        <h2 id="addFormTitle">効果音を追加</h2>
      </div>

      <form id="addForm" class="form" autocomplete="off">
        <label class="field field--name">
          <span class="field__label">表示名</span>
          <input id="nameInput" class="input" type="text" placeholder="ファイル名を入力" />
        </label>

        <label class="field field--key">
          <span class="field__label">再生キー</span>
          <button id="keyCaptureBtn" type="button" class="key-btn" aria-label="キー設定">未設定</button>
          <input id="keyValue" type="hidden" />
        </label>

        <!-- カスタムファイル選択ボタン -->
        <label class="field field--file">
          <span class="field__label">音声ファイル</span>
          <div class="file-row">
            <label class="btn file-btn" id="fileBtnLabel">
              <span class="file-btn__text">音声ファイルを選択</span>
              <input id="fileInput" class="visually-hidden" type="file" accept="audio/*" />
            </label>
            <span id="fileNamePreview" class="file-name-preview">選択されていません</span>
          </div>
        </label>

        <div class="actions">
          <button class="btn btn--primary" type="submit">追加する</button>
          <button id="clearFormBtn" class="btn btn--ghost" type="button">クリア</button>
        </div>
      </form>
    </section>

    <!-- 登録一覧 -->
    <section class="panel panel--list" aria-labelledby="listTitle">
      <div class="panel__head">
        <h2 id="listTitle">登録済みの効果音</h2>
        <div class="list-actions">
          <button id="exportBtn" class="btn btn--ghost">エクスポート</button>
          <button for="importInput" id="importBtnLabel" class="btn btn--ghost">インポート</button>
          <input id="importInput" class="visually-hidden" type="file" accept="application/json" />
          <button id="stopAllBtn" class="btn btn--danger" title="全て停止（Space と同じ）">全停止</button>
        </div>
      </div>

      <div id="soundList" class="grid" aria-live="polite"></div>
    </section>

    <footer class="footer">
      <small>ローカルデータに保存</small>
    </footer>
  </div>

  <!-- サウンドカードのテンプレート -->
  <template id="soundItemTemplate">
    <article class="card" role="article">
      <div class="card__head">
        <h3 class="card__title"></h3>
        <span class="badge key-badge" title="割り当てキー">—</span>
      </div>
      <div class="card__body">
        <div class="card__meta">
          <span class="meta__label">長さ</span>
          <span class="meta__value duration">--:--</span>
        </div>
        <div class="card__spacer"></div>
        <div class="card__status visually-hidden" aria-hidden="true"></div>
      </div>
      <div class="card__actions">
        <button class="btn btn--primary play">再生</button>
        <button class="btn btn--ghost rebind">キー変更</button>
        <button class="btn btn--ghost rename">名前変更</button>
        <button class="btn btn--ghost replace">音源差し替え</button>
        <button class="btn btn--danger delete">削除</button>
      </div>
    </article>
  </template>

  <!-- カスタムリネームモーダル -->
  <div id="renameModal" class="modal" aria-hidden="true" role="dialog" aria-modal="true">
    <div class="modal__backdrop" data-dismiss="modal"></div>
    <div class="modal__panel" role="document" aria-labelledby="renameModalTitle">
      <h3 id="renameModalTitle">名前を変更</h3>
      <p class="modal__desc">新しい名前を入力してください（空欄だと元の名前のまま）</p>
      <input id="renameInput" class="input modal__input" type="text" />
      <div class="modal__actions">
        <button id="renameCancel" class="btn btn--ghost">キャンセル</button>
        <button id="renameConfirm" class="btn btn--primary">保存</button>
      </div>
    </div>
  </div>

  <script src="./app.js" defer></script>
</body>
</html>

